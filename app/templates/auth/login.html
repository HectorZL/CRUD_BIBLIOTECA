{% extends "auth/base_auth.html" %}

{% block title %}Iniciar Sesión - Sistema de Biblioteca{% endblock %}

{% block content %}
    <form method="POST" action="{{ url_for('auth.login') }}" class="needs-validation" novalidate>
        <img class="mb-4" src="https://getbootstrap.com/docs/5.1/assets/brand/bootstrap-logo.svg" alt="" width="72" height="57">
        <h1 class="h3 mb-3 fw-normal">Iniciar Sesión</h1>
        
        <div class="form-floating mb-3">
            <input type="text" class="form-control" id="username" name="username" placeholder="Usuario" required>
            <label for="username">Usuario</label>
            <div class="invalid-feedback">
                Por favor ingrese su nombre de usuario.
            </div>
        </div>
        
        <div class="form-floating mb-3">
            <input type="password" class="form-control" id="password" name="password" placeholder="Contraseña" required>
            <label for="password">Contraseña</label>
            <div class="invalid-feedback">
                Por favor ingrese su contraseña.
            </div>
        </div>
        
        <div class="mb-3">
            <div class="form-check">
                <input type="checkbox" class="form-check-input" id="remember" name="remember">
                <label class="form-check-label" for="remember">Recordarme</label>
            </div>
        </div>
        
        <button class="w-100 btn btn-lg btn-auth" type="submit">Iniciar sesión</button>
        
        <p class="mt-3">
            ¿No tienes una cuenta? 
            {% if session.get('is_admin', False) %}
                <a href="{{ url_for('auth.register') }}" class="text-decoration-none">Registrar nuevo usuario</a>
            {% else %}
                Contacta a un administrador para obtener acceso.
            {% endif %}
        </p>
    </form>
    
    <script>
    // Validación del formulario con Bootstrap
    (function () {
        'use strict'
        
        // Obtener todos los formularios a los que queremos aplicar estilos de validación de Bootstrap personalizados
        var forms = document.querySelectorAll('.needs-validation')
        
        // Bucle sobre ellos y evitar el envío
        Array.prototype.slice.call(forms)
            .forEach(function (form) {
                form.addEventListener('submit', function (event) {
                    if (!form.checkValidity()) {
                        event.preventDefault()
                        event.stopPropagation()
                    }
                    
                    form.classList.add('was-validated')
                }, false)
            })
    })()
    </script>
{% endblock %}
